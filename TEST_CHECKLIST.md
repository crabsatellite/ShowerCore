# ShowerCore 测试清单

## 1. 洗浴喷头 (Shower Head) 交互测试

### 1.1 核心安装与替换

- [ ] **安装核心**：
  - [ ] 准备一个空的洗浴喷头。
  - [ ] 手持任意一种洗浴核心（如：热水核心、玫瑰核心、牛奶核心等）。
  - [ ] **直接右键**点击喷头。
  - [ ] **预期结果**：核心被安装到喷头中，手中的核心数量减少（生存模式）。
- [ ] **替换核心**：
  - [ ] 准备一个已经安装了核心的洗浴喷头。
  - [ ] 手持另一种洗浴核心。
  - [ ] **直接右键**点击喷头。
  - [ ] **预期结果**：
    - 原有的核心以掉落物形式弹出。
    - 新的核心被安装到喷头中。
    - 手中的新核心数量减少（生存模式）。
- [ ] **防止误放置**：
  - [ ] 手持洗浴核心对着喷头右键。
  - [ ] **预期结果**：核心被安装进喷头，而不是作为方块放置在喷头旁边。
- [ ] **移除核心**：
  - [ ] 准备一个已经安装了核心的洗浴喷头。
  - [ ] **空手**并按住 **Shift** 键右键点击喷头。
  - [ ] **预期结果**：
    - 核心以掉落物形式弹出。
    - 喷头变为空。
    - 如果喷头正在运行，喷水效果停止。

### 1.2 喷头开关与效果

- [ ] **开启喷头**：
  - [ ] 确保喷头内已安装核心。
  - [ ] **空手**右键点击喷头。
  - [ ] **预期结果**：
    - 喷头开始喷水。
    - 粒子效果颜色/类型应与安装的核心相匹配（例如：玫瑰核心喷出玫瑰色的水）。
    - 播放流水音效（音量适中，不应过于刺耳）。
- [ ] **关闭喷头**：
  - [ ] 对着正在喷水的喷头，**空手**右键点击。
  - [ ] **预期结果**：喷水停止，粒子效果消失，音效停止。
- [ ] **无核心状态**：
  - [ ] 准备一个空的洗浴喷头（无核心）。
  - [ ] **空手**右键点击喷头。
  - [ ] **预期结果**：提示“需要安装核心”，不会喷水。

### 1.3 数据保存与区块加载

- [ ] **保存与加载**：
  - [ ] 安装核心并开启喷头。
  - [ ] 退出游戏并重新进入。
  - [ ] **预期结果**：
    - 喷头内依然有核心。
    - 喷头依然保持开启状态。
    - **关键**：进入游戏后，粒子效果和声音应自动恢复播放。
- [ ] **区块卸载与加载**：
  - [ ] 开启喷头。
  - [ ] 远离喷头直到区块卸载（或使用指令传送离开）。
  - [ ] 等待片刻后返回喷头所在位置。
  - [ ] **预期结果**：
    - 回到区块后，喷头应继续喷水。
    - 粒子效果和声音应正常恢复，无积攒现象。

### 1.4 方块破坏与掉落

- [ ] **保留核心掉落**：
  - [ ] 在生存模式下，准备一个已安装核心的喷头。
  - [ ] 使用任意工具（如木镐）或空手破坏喷头。
  - [ ] **预期结果**：
    - 掉落一个喷头物品。
    - **不**单独掉落核心物品。
    - 粒子效果和声音立即停止。
- [ ] **物品提示 (Tooltip)**：
  - [ ] 捡起掉落的喷头物品。
  - [ ] 在物品栏中查看该物品的提示信息。
  - [ ] **预期结果**：提示信息中显示灰色文字“内含：[核心名称]”。
- [ ] **重新放置**：
  - [ ] 将该喷头重新放置在地上。
  - [ ] **预期结果**：
    - 喷头内依然包含之前的核心（尝试右键取出或开启验证）。

### 1.5 含水状态 (Waterlogging)

- [ ] **水中放置**：
  - [ ] 在水中放置喷头。
  - [ ] **预期结果**：喷头成功放置，且包含水（不产生气泡空腔）。
- [ ] **倒水测试**：
  - [ ] 对着干燥的喷头使用水桶。
  - [ ] **预期结果**：喷头变为含水状态，水流向四周扩散。
- [ ] **取水测试**：
  - [ ] 对着含水的喷头使用空桶。
  - [ ] **预期结果**：获得水桶，喷头变为干燥状态。
- [ ] **水流冲刷**：
  - [ ] 让流动的水流经喷头位置。
  - [ ] **预期结果**：喷头**不会**被冲毁，而是变为含水状态。

## 2. 粒子效果测试

- [ ] **不同核心的粒子**：
  - [ ] 依次测试所有种类的洗浴核心（热水、草药、牡丹、玫瑰、牛奶、蜂蜜）。
  - [ ] **预期结果**：每种核心都能产生对应的独特粒子效果。
- [ ] **游戏暂停**：
  - [ ] 开启喷头使其喷水。
  - [ ] 按 `Esc` 键暂停游戏（单人模式）。
  - [ ] 等待片刻后返回游戏。
  - [ ] **预期结果**：
    - 暂停期间粒子不应积攒。
    - 返回游戏时，不应出现大量粒子同时爆发的情况。
    - 声音应随游戏暂停而暂停（或至少不积攒播放队列）。

## 3. 增益效果 (Buff) 测试

### 3.1 触发机制与范围

- [ ] **触发延迟与初始效果**：
  - [ ] 站在开启的喷头下。
  - [ ] **预期结果**：前 5 秒无效果，持续停留 5 秒后获得 Buff，初始持续时间约为 20 秒。
- [ ] **持续时间增长与上限**：
  - [ ] 继续停留在喷头下。
  - [ ] **预期结果**：
    - 每隔 10 秒，Buff 持续时间刷新并增加（每次增加约 20 秒）。
    - 持续浸泡一段时间后，Buff 持续时间不再增加，稳定在 **2 分钟**（上限）。
- [ ] **范围检测与遮挡**：
  - [ ] 在喷头下方放置一个方块阻挡水流。
  - [ ] 站在该方块**下方**。
  - [ ] **预期结果**：不获得 Buff（因为水流被阻挡）。
  - [ ] 站在该方块**上方**（水流中）。
  - [ ] **预期结果**：获得 Buff。

### 3.2 核心效果验证

- [ ] **热水核心 (Hot Water)**：
  - [ ] 安装热水核心并开启。
  - [ ] **预期结果**：获得 **速度 II** (Speed II)。
- [ ] **牛奶浴核心 (Milk Bath)**：
  - [ ] 给予自己负面效果（如 `/effect give @s poison 10`）。
  - [ ] 消耗部分饱食度。
  - [ ] 站在喷头下。
  - [ ] **预期结果**：
    - 获得 **生命恢复 II** (Regeneration II)。
    - **负面效果被移除**（中毒、凋零、缓慢、虚弱、反胃、失明、饥饿）。
    - 每 15 秒获得一次 **饱和** (Saturation) 恢复饱食度。
- [ ] **中草药浴核心 (Herbal Bath)**：
  - [ ] 给予自己负面效果。
  - [ ] 站在喷头下。
  - [ ] **预期结果**：
    - 获得 **生命恢复 II** 和 **抗性提升 II** (Resistance II)。
    - **负面效果被移除**。
  - [ ] **亡灵杀手测试**：
    - 在喷头下生成僵尸或骷髅。
    - **预期结果**：亡灵生物每 2 秒受到 1 点伤害。
- [ ] **牡丹浴核心 (Peony Bath)**：
  - [ ] 给予自己不祥之兆 (`/effect give @s bad_omen`) 和其他负面效果。
  - [ ] 站在喷头下。
  - [ ] **预期结果**：
    - 获得 **生命恢复 II**、**幸运 II** (Luck II)、**急迫 II** (Haste II)。
    - **移除不祥之兆**。
    - **移除其他负面效果**。
- [ ] **蜂蜜浴核心 (Honey Bath)**：
  - [ ] 消耗部分饱食度。
  - [ ] 站在喷头下。
  - [ ] **预期结果**：
    - 获得 **生命恢复 II** 和 **伤害吸收 IV** (Absorption IV, 黄心)。
    - 每 4 秒获得一次 **饱和** (Saturation) 快速恢复饱食度。
- [ ] **玫瑰浴核心 (Rose Bath)**：
  - [ ] 给予自己不祥之兆和其他负面效果。
  - [ ] 站在喷头下。
  - [ ] **预期结果**：
    - 获得 **生命恢复 II** 和 **力量 II** (Strength II)。
    - **移除不祥之兆**。
    - **移除其他负面效果**。

### 3.3 效果叠加与共存

- [ ] **同种核心叠加**：
  - [ ] 站在两个相邻的同种核心喷头下（例如两个蜂蜜浴）。
  - [ ] **预期结果**：
    - Buff 等级不变。
    - Buff 持续时间的增长速度应保持正常（每 10 秒刷新一次），**不应**因为有两个喷头而双倍增长。
    - 饱和回复频率应保持正常，不会加倍。
- [ ] **异种核心共存**：
  - [ ] 站在两个相邻的不同核心喷头下（例如热水 + 玫瑰）。
  - [ ] **预期结果**：同时获得 **速度 II** 和 **力量 II**。

## 4. 浴缸 (Bathtub) 测试

### 4.1 放置与破坏

- [ ] **放置**：
  - [ ] 放置浴缸。
  - [ ] **预期结果**：占据两个方块空间（头端和脚端），方向正确。
- [ ] **破坏**：
  - [ ] 破坏浴缸的任意一部分（头端或脚端）。
  - [ ] **预期结果**：整个浴缸被破坏，掉落浴缸物品。

### 4.2 液体交互

- [ ] **加水**：
  - [ ] 手持水桶右键点击空浴缸。
  - [ ] **预期结果**：浴缸充满水，材质变为蓝色水面。
- [ ] **加特殊液体**：
  - [ ] 手持 Hotbath 模组的液体桶（如热水、牛奶浴等）右键点击空浴缸。
  - [ ] **预期结果**：浴缸充满对应液体，材质颜色正确（如牛奶为白色，玫瑰为粉色）。
- [ ] **取水**：
  - [ ] 手持空桶右键点击装满液体的浴缸。
  - [ ] **预期结果**：浴缸变空，获得对应的液体桶。
- [ ] **创造模式**：
  - [ ] 创造模式下进行上述操作。
  - [ ] **预期结果**：桶不消耗/不增加，浴缸状态正常改变。

### 4.3 水龙头开关 (Running Water)

- [ ] **开启水龙头**：
  - [ ] 浴缸内有液体时，**空手并按住 Shift 键**右键点击**水龙头模型**。
  - [ ] **预期结果**：出现流动的液体粒子/模型效果，颜色与缸内液体一致，播放流水音效。
- [ ] **关闭水龙头**：
  - [ ] 再次**空手并按住 Shift 键**右键点击**水龙头模型**。
  - [ ] **预期结果**：水流效果消失，音效停止。
- [ ] **空缸保护**：
  - [ ] 浴缸为空时，尝试开启水龙头。
  - [ ] **预期结果**：无法开启，无效果。
- [ ] **自动关闭**：
  - [ ] 开启水龙头后，用桶将水取走。
  - [ ] **预期结果**：水流效果自动消失。
- [ ] **独立交互区域**：
  - [ ] 鼠标指向水龙头。
  - [ ] **预期结果**：只有水龙头部分被高亮显示，与浴缸主体分离。

### 4.4 坐入浴缸 (Sitting)

- [ ] **坐入 (Foot)**：
  - [ ] **空手**（不按 Shift）右键点击**浴缸尾部（Foot）**。
  - [ ] **预期结果**：玩家坐入浴缸中（位置在龙头下方），视角高度降低。
- [ ] **坐入 (Head)**：
  - [ ] **空手**（不按 Shift）右键点击**浴缸头部（Head）**（避开水龙头）。
  - [ ] **预期结果**：玩家坐入浴缸中。
- [ ] **离开**：
  - [ ] 按下潜行键（Shift）。
  - [ ] **预期结果**：玩家脱离浴缸，站立在旁边。

### 4.5 浴缸效果 (Bathtub Effects)

- [ ] **站立触发**：
  - [ ] 站在装有特殊液体（如热水、药浴）的浴缸内。
  - [ ] **预期结果**：获得对应的 Buff 效果（如热水给予速度，药浴给予生命恢复等）。
- [ ] **坐下触发**：
  - [ ] 右键坐入装有特殊液体的浴缸。
  - [ ] **预期结果**：获得对应的 Buff 效果。
- [ ] **边缘判定（防误触）**：
  - [ ] 站在浴缸的边缘（Rim）上，或者站在浴缸内的水面上方（未接触液体）。
  - [ ] **预期结果**：**不**获得 Buff 效果。
- [ ] **不同液体测试**：
  - [ ] 依次测试热水、草药浴、牛奶浴等。
  - [ ] **预期结果**：每种液体都能正确触发其对应的效果。

## 5. 通用液体与浴缸渲染测试 (Generic Fluids & Rendering)

### 5.1 任意液体支持

- [ ] **倒入液体**：
  - [ ] 手持任意液体桶（如岩浆桶、其他模组的液体桶）。
  - [ ] 右键点击浴缸。
  - [ ] **预期结果**：
    - 液体被倒入浴缸。
    - 桶变为空桶。
    - 浴缸内显示出该液体的液面。
- [ ] **取出液体**：
  - [ ] 手持空桶右键点击装有液体的浴缸。
  - [ ] **预期结果**：
    - 液体被取出。
    - 桶变为对应的液体桶。
    - 浴缸变空。

### 5.2 渲染测试

- [ ] **自定义液体渲染**：
  - [ ] 倒入其他模组的液体（如 Tinker's Construct 的熔融金属）。
  - [ ] **预期结果**：液面应显示该流体正确的纹理和颜色，且浴缸本身不应出现紫黑块（丢失材质）。
- [ ] **多材质浴缸测试**：
  - [ ] 在木质、石质、金属等不同材质的浴缸中重复上述测试。
  - [ ] **预期结果**：所有材质的浴缸都能正确渲染内部液体。

### 5.3 蒸汽配置测试

- [ ] **默认行为**：
  - [ ] 倒入岩浆或其他非内置热流体。
  - [ ] **预期结果**：默认情况下不产生蒸汽粒子。
- [ ] **配置生效**：
  - [ ] 在 `config/showercore-common.toml` 中将该流体加入 `steam_fluids` 列表。
  - [ ] 重启游戏或重载配置。
  - [ ] **预期结果**：该流体现在会在浴缸上方产生蒸汽粒子。

### 5.4 岩浆效果测试 (Lava Effects)

- [ ] **伤害测试**：
  - [ ] 将浴缸装满岩浆。
  - [ ] 跳入浴缸（生存模式）。
  - [ ] **预期结果**：玩家立即着火，并持续受到伤害（模拟岩浆伤害）。
- [ ] **生物测试**：
  - [ ] 将生物（如猪、牛）推入装有岩浆的浴缸。
  - [ ] **预期结果**：生物着火并受到伤害死亡。

## 6. 小黄鸭 (Rubber Duck) 测试

### 6.1 物理与运动

- [ ] **重力与掉落**：
  - [ ] 在空中放置小黄鸭。
  - [ ] **预期结果**：小黄鸭受重力影响自然下落。
- [ ] **流体浮力**：
  - [ ] 将小黄鸭放入水中。
  - [ ] **预期结果**：小黄鸭漂浮在水面上，不会沉底。
- [ ] **浴缸浮力**：
  - [ ] 将小黄鸭放入装有水的浴缸中。
  - [ ] **预期结果**：小黄鸭漂浮在浴缸内的水面上（高度约 0.65），不会沉入浴缸底部。
- [ ] **流体销毁**：
  - [ ] 将小黄鸭放入岩浆中。
  - [ ] **预期结果**：小黄鸭被销毁，播放燃烧音效并产生火焰粒子。
  - [ ] **配置测试**：在配置文件中添加其他流体，验证小黄鸭在这些流体中是否也会被销毁。
- [ ] **阻力**：
  - [ ] 观察小黄鸭在空气中和水中的移动。
  - [ ] **预期结果**：在水中移动时阻力较大，停止得更快；在空气中阻力较小。

### 6.2 交互与操作

- [ ] **推动**：
  - [ ] **右键**点击小黄鸭。
  - [ ] **预期结果**：小黄鸭被轻微推动，并在水面上产生涟漪粒子。
- [ ] **旋转力矩**：
  - [ ] 点击小黄鸭的左侧或右侧。
  - [ ] **预期结果**：小黄鸭根据点击位置产生旋转（点击左侧向右转，点击右侧向左转）。
- [ ] **手臂影响**：
  - [ ] 分别使用主手（右手）和副手（左手）推动小黄鸭。
  - [ ] **预期结果**：
    - 右手推动产生向左的侧向力。
    - 左手推动产生向右的侧向力。
- [ ] **拾取**：
  - [ ] **空手**并按住 **Shift** 键右键点击小黄鸭。
  - [ ] **预期结果**：小黄鸭实体消失，玩家获得小黄鸭物品。

### 6.3 浴缸集成

- [ ] **优先放置**：
  - [ ] 手持小黄鸭物品，右键点击浴缸（无论是否装水）。
  - [ ] **预期结果**：
    - 玩家**不会**坐入浴缸。
    - 小黄鸭被放置在浴缸中。
- [ ] **共存**：
  - [ ] 在浴缸中放置小黄鸭后，玩家尝试坐入浴缸。
  - [ ] **预期结果**：玩家可以正常坐入浴缸，与小黄鸭共存。
